2024-04-22T13:38:38.313863+0300 | INFO | None:<module>:20 - Started logging successfully
2024-04-22T13:38:38.706886+0300 | DEBUG | MessageHandler:listen_blank_messages:167 - Got 5 blank messages
2024-04-22T13:38:38.707391+0300 | INFO | MessageHandler:fill_blank_message:26 - Got blank_message = <dtypes.message.Message object at 0x1052a6f90>
2024-04-22T13:38:38.708493+0300 | INFO | MessageHandler:fill_blank_message:26 - Got blank_message = <dtypes.message.Message object at 0x1052a7150>
2024-04-22T13:38:38.708911+0300 | INFO | MessageHandler:fill_blank_message:26 - Got blank_message = <dtypes.message.Message object at 0x1052a7dd0>
2024-04-22T13:38:38.709188+0300 | INFO | MessageHandler:fill_blank_message:26 - Got blank_message = <dtypes.message.Message object at 0x1052a7790>
2024-04-22T13:38:38.709430+0300 | INFO | MessageHandler:fill_blank_message:26 - Got blank_message = <dtypes.message.Message object at 0x1052b8810>
2024-04-22T13:38:40.032526+0300 | WARNING | MessageHandler:fill_blank_message:40 - Got wrong gpt response -> {'status': 'ok', 'description': 'ok', 'data': None}
2024-04-22T13:38:40.962017+0300 | WARNING | MessageHandler:fill_blank_message:40 - Got wrong gpt response -> {'status': 'ok', 'description': 'ok', 'data': None}
2024-04-22T13:38:47.199634+0300 | INFO | MessageHandler:fill_blank_message:45 - Got gpt response -> {'status': 'ok', 'description': 'ok', 'data': "It seems we're still having difficulty establishing a clear conversation. If there is a specific way I can assist you or if you have questions about our services at Innova Consulting Group, please provide some details. I'm here to help."}
2024-04-22T13:38:47.249793+0300 | DEBUG | MessageHandler:fill_blank_message:50 - Got updated_message_response -> {'status': 'ok', 'description': 'ok', 'data': "UpdateResult({'n': 1, 'electionId': ObjectId('7fffffff00000000000000bd'), 'opTime': {'ts': Timestamp(1713782327, 18), 't': 189}, 'nModified': 1, 'ok': 1.0, '$clusterTime': {'clusterTime': Timestamp(1713782327, 18), 'signature': {'hash': b'(\\xc5u_\\x8cRnt\\x87\\\\\\x0b\\xb4\\x16\\xd9\\xab\\x86\\x17\\xc2\\xac\\xb2', 'keyId': 7306544719813672961}}, 'operationTime': Timestamp(1713782327, 18), 'updatedExisting': True}, acknowledged=True)"}
2024-04-22T13:38:50.514947+0300 | WARNING | MessageHandler:fill_blank_message:40 - Got wrong gpt response -> {'status': 'ok', 'description': 'ok', 'data': None}
2024-04-22T13:39:00.652458+0300 | INFO | MessageHandler:fill_blank_message:45 - Got gpt response -> {'status': 'ok', 'description': 'ok', 'data': 'I\'m here to assist, but it seems there might be a misunderstanding or technical issue, as your inquiry about "Crystal: Форма слайдера" has been repeated without variation. If you\'ve specific requirements or questions about this topic, detailing them would greatly aid in providing you with accurate and helpful information.\n\nIn the context of slider forms, whether it involves design, implementation, or optimization for user engagement, Innova Consulting Group possesses the expertise and experience to support your needs effectively. Please share more about your project goals, the challenges you\'re facing, or any particular aspects of the slider form you\'re interested in discussing.\n\nYour cooperation and additional details are much appreciated to move forward constructively.\n\nBest regards,\nOleg Shevchenko'}
2024-04-22T13:39:00.653996+0300 | ERROR | MessageHandler:fill_blank_message:54 - [Errno None] Can not write request body for http://127.0.0.1:6660/update_message
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client_reqrep.py", line 626, in write_bytes
    await self.body.write(writer)
          │    │    │     └ <aiohttp.http_writer.StreamWriter object at 0x1049ea3d0>
          │    │    └ <function BytesPayload.write at 0x104db8720>
          │    └ <aiohttp.payload.JsonPayload object at 0x1052d0490>
          └ <aiohttp.client_reqrep.ClientRequest object at 0x1052a7310>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/payload.py", line 245, in write
    await writer.write(self._value)
          │      │     │    └ b'{"id": "b88b4b7c6efb343c9306f8f1f5da407b_420_reply", "reply_to_id": "b88b4b7c6efb343c9306f8f1f5da407b_420", "dialog_id": "b...
          │      │     └ <aiohttp.payload.JsonPayload object at 0x1052d0490>
          │      └ <function StreamWriter.write at 0x104d85f80>
          └ <aiohttp.http_writer.StreamWriter object at 0x1049ea3d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/http_writer.py", line 115, in write
    self._write(chunk)
    │    │      └ b'{"id": "b88b4b7c6efb343c9306f8f1f5da407b_420_reply", "reply_to_id": "b88b4b7c6efb343c9306f8f1f5da407b_420", "dialog_id": "b...
    │    └ <function StreamWriter._write at 0x104d85ee0>
    └ <aiohttp.http_writer.StreamWriter object at 0x1049ea3d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/http_writer.py", line 75, in _write
    raise ConnectionResetError("Cannot write to closing transport")

ConnectionResetError: Cannot write to closing transport


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...ate_message')>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...ate_message')>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...ate_message')>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...ate_message')>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 47, in fill_blank_message
    async with http_client.post(f"{CONN_API}/update_message", json=clear(blank_message.to_dict())) as response:
               │           │                                       │     │             │              └ <ClientResponse(http://127.0.0.1:6660/manager) [200 OK]>
               │           │                                       │     │             │                <CIMultiDictProxy('Date': 'Mon, 22 Apr 2024 10:38:38 GMT', 'Server':...
               │           │                                       │     │             └ <function Jsonified.to_dict at 0x105282fc0>
               │           │                                       │     └ <dtypes.message.Message object at 0x1052b8810>
               │           │                                       └ <function clear at 0x105282ca0>
               │           └ <function ClientSession.post at 0x10513c540>
               └ <aiohttp.client.ClientSession object at 0x1052bbf50>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105286140>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105286140>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 605, in _request
    await resp.start(conn)
          │    │     └ Connection<ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_headers_hash...
          │    └ <function ClientResponse.start at 0x104e03ec0>
          └ <ClientResponse(http://127.0.0.1:6660/update_message) [None None]>
            None
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client_reqrep.py", line 966, in start
    message, payload = await protocol.read()  # type: ignore[union-attr]
                             │        └ <function DataQueue.read at 0x104d90ea0>
                             └ <aiohttp.client_proto.ResponseHandler object at 0x1052a0f30>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/streams.py", line 622, in read
    await self._waiter
          │    └ None
          └ <aiohttp.client_proto.ResponseHandler object at 0x1052a0f30>

aiohttp.client_exceptions.ClientOSError: [Errno None] Can not write request body for http://127.0.0.1:6660/update_message
2024-04-22T13:39:03.587164+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1052b8ad0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10523e190>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1052857e0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1052857e0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1052b8ad0>
                 └ <aiohttp.client.ClientSession object at 0x10523e190>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x10537f690>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1052b8ad0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x10537f690>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1052b8ad0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1052b8ad0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x10537f690>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:39:05.673312+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1052d10d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1052b8a50>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285870>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285870>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1052d10d0>
                 └ <aiohttp.client.ClientSession object at 0x1052b8a50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054758d0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1052d10d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054758d0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1052d10d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1052d10d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054758d0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:39:08.604897+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1052a7050>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10538e250>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285360>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285360>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1052a7050>
                 └ <aiohttp.client.ClientSession object at 0x10538e250>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x105476ad0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1052a7050>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x105476ad0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1052a7050>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1052a7050>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x105476ad0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:39:10.689340+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x105477210>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1052d3dd0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1052853c0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1052853c0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105477210>
                 └ <aiohttp.client.ClientSession object at 0x1052d3dd0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x10549c0d0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x105477210>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x10549c0d0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x105477210>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x105477210>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x10549c0d0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:39:13.620524+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x105477c90>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10537fd10>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1052862f0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1052862f0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105477c90>
                 └ <aiohttp.client.ClientSession object at 0x10537fd10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x10549d690>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x105477c90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x10549d690>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x105477c90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x105477c90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x10549d690>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:39:15.705084+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x105476690>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10537e550>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105361ab0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105361ab0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105476690>
                 └ <aiohttp.client.ClientSession object at 0x10537e550>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x10549eb50>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x105476690>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x10549eb50>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x105476690>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x105476690>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x10549eb50>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:39:18.637921+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x105476d50>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x105476950>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105361cf0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105361cf0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105476d50>
                 └ <aiohttp.client.ClientSession object at 0x105476950>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a4050>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x105476d50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a4050>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x105476d50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x105476d50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a4050>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:39:20.717766+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x10537cc50>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10529f590>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1052853f0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1052853f0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x10537cc50>
                 └ <aiohttp.client.ClientSession object at 0x10529f590>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x105477250>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x10537cc50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x105477250>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x10537cc50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x10537cc50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x105477250>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:39:23.658031+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x105477dd0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x105476e90>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285c60>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285c60>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105477dd0>
                 └ <aiohttp.client.ClientSession object at 0x105476e90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x105475f50>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x105477dd0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x105475f50>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x105477dd0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x105477dd0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x105475f50>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:39:25.730432+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x105475e50>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1052a7d90>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285780>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285780>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105475e50>
                 └ <aiohttp.client.ClientSession object at 0x1052a7d90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x10549c110>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x105475e50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x10549c110>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x105475e50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x105475e50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x10549c110>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:39:28.670169+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x10549fb90>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10549c9d0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105286380>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105286380>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x10549fb90>
                 └ <aiohttp.client.ClientSession object at 0x10549c9d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a50d0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x10549fb90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a50d0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x10549fb90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x10549fb90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a50d0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:39:30.746997+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x10549d290>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10549f410>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1052862c0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1052862c0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x10549d290>
                 └ <aiohttp.client.ClientSession object at 0x10549f410>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a6690>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x10549d290>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a6690>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x10549d290>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x10549d290>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a6690>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:39:33.683891+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054a6890>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x105476bd0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105361780>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105361780>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054a6890>
                 └ <aiohttp.client.ClientSession object at 0x105476bd0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a7b10>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054a6890>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a7b10>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054a6890>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054a6890>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a7b10>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:39:35.763922+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054a7350>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054a6f90>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105361600>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105361600>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054a7350>
                 └ <aiohttp.client.ClientSession object at 0x1054a6f90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b5090>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054a7350>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b5090>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054a7350>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054a7350>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b5090>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:39:38.702787+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1052d1150>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10535da50>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285ab0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285ab0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1052d1150>
                 └ <aiohttp.client.ClientSession object at 0x10535da50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1052b8590>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1052d1150>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1052b8590>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1052d1150>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1052d1150>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1052b8590>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:39:40.780628+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1052d0d90>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10529f590>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1052860b0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1052860b0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1052d0d90>
                 └ <aiohttp.client.ClientSession object at 0x10529f590>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x105477090>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1052d0d90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x105477090>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1052d0d90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1052d0d90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x105477090>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:39:43.715734+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x105476b10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10537fad0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285390>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285390>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105476b10>
                 └ <aiohttp.client.ClientSession object at 0x10537fad0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x10549cc10>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x105476b10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x10549cc10>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x105476b10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x105476b10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x10549cc10>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:39:45.795722+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x10549c6d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10549c5d0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105361720>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105361720>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x10549c6d0>
                 └ <aiohttp.client.ClientSession object at 0x10549c5d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a4a50>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x10549c6d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a4a50>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x10549c6d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x10549c6d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a4a50>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:39:48.733558+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054a5350>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x105374c50>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105362ad0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105362ad0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054a5350>
                 └ <aiohttp.client.ClientSession object at 0x105374c50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b6290>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054a5350>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b6290>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054a5350>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054a5350>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b6290>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:39:50.808716+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x105377510>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1052a7d90>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105361d20>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105361d20>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105377510>
                 └ <aiohttp.client.ClientSession object at 0x1052a7d90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b7750>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x105377510>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b7750>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x105377510>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x105377510>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b7750>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:39:53.749988+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054b7050>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054b79d0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105362020>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105362020>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054b7050>
                 └ <aiohttp.client.ClientSession object at 0x1054b79d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b8d50>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054b7050>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b8d50>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054b7050>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054b7050>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b8d50>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:39:55.826207+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054b5f90>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1052a7050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105286200>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105286200>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054b5f90>
                 └ <aiohttp.client.ClientSession object at 0x1052a7050>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a6010>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054b5f90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a6010>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054b5f90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054b5f90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a6010>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:39:58.767689+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054b5a10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x105374b10>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285690>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285690>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054b5a10>
                 └ <aiohttp.client.ClientSession object at 0x105374b10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a7990>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054b5a10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a7990>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054b5a10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054b5a10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a7990>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:00.843527+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x10535e490>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10537e590>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285480>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285480>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x10535e490>
                 └ <aiohttp.client.ClientSession object at 0x10537e590>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1052d0d90>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x10535e490>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1052d0d90>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x10535e490>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x10535e490>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1052d0d90>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:03.784977+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x105475350>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1052d3e90>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105362320>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105362320>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105475350>
                 └ <aiohttp.client.ClientSession object at 0x1052d3e90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b97d0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x105475350>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b97d0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x105475350>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x105475350>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b97d0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:05.858083+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x10549c190>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10549d2d0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1053610f0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1053610f0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x10549c190>
                 └ <aiohttp.client.ClientSession object at 0x10549d2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054bad50>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x10549c190>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054bad50>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x10549c190>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x10549c190>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054bad50>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:08.800186+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054a5690>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1050d3ed0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105362470>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105362470>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054a5690>
                 └ <aiohttp.client.ClientSession object at 0x1050d3ed0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c44d0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054a5690>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c44d0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054a5690>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054a5690>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c44d0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:10.875714+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054baf10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10549d490>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1053629e0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1053629e0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054baf10>
                 └ <aiohttp.client.ClientSession object at 0x10549d490>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c5950>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054baf10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c5950>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054baf10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054baf10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c5950>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:13.814808+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x10523e190>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1053b9c10>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1052857e0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1052857e0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x10523e190>
                 └ <aiohttp.client.ClientSession object at 0x1053b9c10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b9d50>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x10523e190>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b9d50>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x10523e190>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x10523e190>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b9d50>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:15.895230+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054bab50>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054ba010>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285f90>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285f90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054bab50>
                 └ <aiohttp.client.ClientSession object at 0x1054ba010>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1052d1510>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054bab50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1052d1510>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054bab50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054bab50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1052d1510>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:18.830663+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x10549c1d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1052a7050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285ab0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285ab0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x10549c1d0>
                 └ <aiohttp.client.ClientSession object at 0x1052a7050>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b7ed0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x10549c1d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b7ed0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x10549c1d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x10549c1d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b7ed0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:20.910842+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1053b4750>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054b5710>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105362a70>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105362a70>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1053b4750>
                 └ <aiohttp.client.ClientSession object at 0x1054b5710>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c6590>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1053b4750>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c6590>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1053b4750>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1053b4750>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c6590>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:23.849943+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x105477d50>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054b75d0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105361210>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105361210>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105477d50>
                 └ <aiohttp.client.ClientSession object at 0x1054b75d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c7910>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x105477d50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c7910>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x105477d50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x105477d50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c7910>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:25.927152+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054c7710>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054a60d0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105362bf0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105362bf0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054c7710>
                 └ <aiohttp.client.ClientSession object at 0x1054a60d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054d8f90>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054c7710>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054d8f90>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054c7710>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054c7710>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054d8f90>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:28.873339+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054b9710>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054b9f90>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105362dd0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105362dd0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054b9710>
                 └ <aiohttp.client.ClientSession object at 0x1054b9f90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054d9b50>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054b9710>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054d9b50>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054b9710>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054b9710>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054d9b50>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:30.942805+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054c6b10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1053b4750>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1052857b0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1052857b0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054c6b10>
                 └ <aiohttp.client.ClientSession object at 0x1053b4750>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c68d0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054c6b10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c68d0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054c6b10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054c6b10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c68d0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:33.894596+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054c6850>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1053b4550>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285390>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285390>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054c6850>
                 └ <aiohttp.client.ClientSession object at 0x1053b4550>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x105477ed0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054c6850>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x105477ed0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054c6850>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054c6850>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x105477ed0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:35.976024+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1053b9c10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10535da50>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1052855a0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1052855a0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1053b9c10>
                 └ <aiohttp.client.ClientSession object at 0x10535da50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054ba290>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1053b9c10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054ba290>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1053b9c10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1053b9c10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054ba290>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:38.917045+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054baa90>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1052d2050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105363130>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105363130>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054baa90>
                 └ <aiohttp.client.ClientSession object at 0x1052d2050>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054db110>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054baa90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054db110>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054baa90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054baa90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054db110>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:40.996011+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x10549e090>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1052b8a50>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105362320>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105362320>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x10549e090>
                 └ <aiohttp.client.ClientSession object at 0x1052b8a50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e0690>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x10549e090>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e0690>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x10549e090>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x10549e090>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e0690>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:43.940889+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054dac10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054b95d0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1053631f0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1053631f0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054dac10>
                 └ <aiohttp.client.ClientSession object at 0x1054b95d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e1b10>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054dac10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e1b10>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054dac10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054dac10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e1b10>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:46.014355+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x105475f50>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054bac50>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105363400>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105363400>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105475f50>
                 └ <aiohttp.client.ClientSession object at 0x1054bac50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e3050>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x105475f50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e3050>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x105475f50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x105475f50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e3050>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:48.958794+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054db590>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1052e78d0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1052853c0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1052853c0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054db590>
                 └ <aiohttp.client.ClientSession object at 0x1052e78d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054dbc50>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054db590>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054dbc50>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054db590>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054db590>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054dbc50>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:51.076553+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054db750>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10535da50>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285d50>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285d50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054db750>
                 └ <aiohttp.client.ClientSession object at 0x10535da50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x105475b10>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054db750>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x105475b10>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054db750>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054db750>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x105475b10>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:53.976255+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1052d34d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10523e910>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1052860b0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1052860b0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1052d34d0>
                 └ <aiohttp.client.ClientSession object at 0x10523e910>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a4390>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1052d34d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a4390>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1052d34d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1052d34d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a4390>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:56.097195+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054a48d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054c6550>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105363790>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105363790>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054a48d0>
                 └ <aiohttp.client.ClientSession object at 0x1054c6550>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e3cd0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054a48d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e3cd0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054a48d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054a48d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e3cd0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:40:58.994526+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1052d3ed0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054b4d90>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105363190>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105363190>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1052d3ed0>
                 └ <aiohttp.client.ClientSession object at 0x1054b4d90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e5090>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1052d3ed0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e5090>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1052d3ed0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1052d3ed0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e5090>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:01.112063+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054c76d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054a5f90>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105363850>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105363850>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054c76d0>
                 └ <aiohttp.client.ClientSession object at 0x1054a5f90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e6390>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054c76d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e6390>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054c76d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054c76d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e6390>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:04.014747+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x102cfdd90>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054b7250>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105363a90>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105363a90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x102cfdd90>
                 └ <aiohttp.client.ClientSession object at 0x1054b7250>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e7590>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x102cfdd90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e7590>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x102cfdd90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x102cfdd90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e7590>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:06.134133+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x10549c110>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10549f510>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285780>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285780>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x10549c110>
                 └ <aiohttp.client.ClientSession object at 0x10549f510>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e0e90>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x10549c110>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e0e90>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x10549c110>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x10549c110>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e0e90>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:09.031485+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054c6ed0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054c6550>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285600>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285600>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054c6ed0>
                 └ <aiohttp.client.ClientSession object at 0x1054c6550>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b4a90>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054c6ed0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b4a90>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054c6ed0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054c6ed0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b4a90>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:11.168772+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x105476e90>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x105477950>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285480>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285480>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105476e90>
                 └ <aiohttp.client.ClientSession object at 0x105477950>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054bb6d0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x105476e90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054bb6d0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x105476e90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x105476e90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054bb6d0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:14.041780+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054c4050>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054b9dd0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105363df0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105363df0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054c4050>
                 └ <aiohttp.client.ClientSession object at 0x1054b9dd0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f4250>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054c4050>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f4250>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054c4050>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054c4050>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f4250>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:16.189632+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x10549d110>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10537fc50>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1053637f0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1053637f0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x10549d110>
                 └ <aiohttp.client.ClientSession object at 0x10537fc50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f55d0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x10549d110>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f55d0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x10549d110>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x10549d110>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f55d0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:19.060756+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x10549e690>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054c6990>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105363eb0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105363eb0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x10549e690>
                 └ <aiohttp.client.ClientSession object at 0x1054c6990>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f6a50>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x10549e690>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f6a50>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x10549e690>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x10549e690>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f6a50>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:21.207923+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1052e78d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10538e2d0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105363f70>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105363f70>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1052e78d0>
                 └ <aiohttp.client.ClientSession object at 0x10538e2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f7f50>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1052e78d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f7f50>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1052e78d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1052e78d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f7f50>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:24.074752+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054f6550>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054f5290>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105363d60>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105363d60>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054f6550>
                 └ <aiohttp.client.ClientSession object at 0x1054f5290>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f45d0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054f6550>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f45d0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054f6550>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054f6550>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f45d0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:26.217925+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054f5150>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054f4550>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105363c70>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105363c70>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054f5150>
                 └ <aiohttp.client.ClientSession object at 0x1054f4550>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054bb8d0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054f5150>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054bb8d0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054f5150>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054f5150>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054bb8d0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:29.090132+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054db650>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054b9dd0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105286290>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105286290>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054db650>
                 └ <aiohttp.client.ClientSession object at 0x1054b9dd0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a48d0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054db650>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a48d0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054db650>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054db650>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054a48d0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:31.240163+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054c6690>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x105475f90>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285c60>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285c60>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054c6690>
                 └ <aiohttp.client.ClientSession object at 0x105475f90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f0950>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054c6690>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f0950>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054c6690>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054c6690>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f0950>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:34.109020+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054e1a10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1053b9b50>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285ab0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285ab0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054e1a10>
                 └ <aiohttp.client.ClientSession object at 0x1053b9b50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f1d50>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054e1a10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f1d50>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054e1a10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054e1a10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f1d50>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:36.335431+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054b8590>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054e2e10>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1054f8400>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1054f8400>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054b8590>
                 └ <aiohttp.client.ClientSession object at 0x1054e2e10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f2d50>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054b8590>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f2d50>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054b8590>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054b8590>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f2d50>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:39.124980+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054c4290>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1052ba490>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1054f8730>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1054f8730>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054c4290>
                 └ <aiohttp.client.ClientSession object at 0x1052ba490>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x10550c750>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054c4290>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x10550c750>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054c4290>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054c4290>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x10550c750>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:41.341875+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x10549c550>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1052d2210>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285300>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285300>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x10549c550>
                 └ <aiohttp.client.ClientSession object at 0x1052d2210>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f0fd0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x10549c550>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f0fd0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x10549c550>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x10549c550>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f0fd0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:44.142020+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054e3c10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054e3e90>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285390>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285390>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054e3c10>
                 └ <aiohttp.client.ClientSession object at 0x1054e3e90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x105477310>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054e3c10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x105477310>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054e3c10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054e3c10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x105477310>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:46.366642+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054a6010>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1052b8ad0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1052853f0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1052853f0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054a6010>
                 └ <aiohttp.client.ClientSession object at 0x1052b8ad0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e4350>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054a6010>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e4350>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054a6010>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054a6010>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e4350>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:49.159380+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054e4290>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x105477ad0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1053622c0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1053622c0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054e4290>
                 └ <aiohttp.client.ClientSession object at 0x105477ad0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x10550ce90>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054e4290>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x10550ce90>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054e4290>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054e4290>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x10550ce90>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:51.389089+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054b5750>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054e5f90>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1054f87c0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1054f87c0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054b5750>
                 └ <aiohttp.client.ClientSession object at 0x1054e5f90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x10550e2d0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054b5750>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x10550e2d0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054b5750>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054b5750>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x10550e2d0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:54.180761+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x105476a50>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054a4910>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1054f8b50>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1054f8b50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105476a50>
                 └ <aiohttp.client.ClientSession object at 0x1054a4910>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x10550f6d0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x105476a50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x10550f6d0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x105476a50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x105476a50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x10550f6d0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:56.405705+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x10550f8d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10549c690>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1054f8d60>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1054f8d60>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x10550f8d0>
                 └ <aiohttp.client.ClientSession object at 0x10549c690>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x105514b10>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x10550f8d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x105514b10>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x10550f8d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x10550f8d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x105514b10>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:41:59.197760+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x10550c6d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x102935690>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105363b50>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105363b50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x10550c6d0>
                 └ <aiohttp.client.ClientSession object at 0x102935690>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x10550d110>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x10550c6d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x10550d110>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x10550c6d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x10550c6d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x10550d110>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:01.423606+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054e7890>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054e65d0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105363e50>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105363e50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054e7890>
                 └ <aiohttp.client.ClientSession object at 0x1054e65d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x105475fd0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054e7890>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x105475fd0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054e7890>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054e7890>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x105475fd0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:04.216070+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x105475710>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054db3d0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285e70>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285e70>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105475710>
                 └ <aiohttp.client.ClientSession object at 0x1054db3d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x10549ca90>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x105475710>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x10549ca90>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x105475710>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x105475710>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x10549ca90>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:06.441749+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054f0f50>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10549f550>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105286200>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105286200>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054f0f50>
                 └ <aiohttp.client.ClientSession object at 0x10549f550>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f7250>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054f0f50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f7250>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054f0f50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054f0f50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f7250>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:09.231523+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054f4510>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054f19d0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1054f8df0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1054f8df0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054f4510>
                 └ <aiohttp.client.ClientSession object at 0x1054f19d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x105516490>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054f4510>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x105516490>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054f4510>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054f4510>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x105516490>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:11.457362+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054c6c10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054f7310>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1054f9180>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1054f9180>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054c6c10>
                 └ <aiohttp.client.ClientSession object at 0x1054f7310>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x105517910>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054c6c10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x105517910>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054c6c10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054c6c10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x105517910>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:14.247964+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x105517f90>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10536fa50>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1054f9390>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1054f9390>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105517f90>
                 └ <aiohttp.client.ClientSession object at 0x10536fa50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x105520c90>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x105517f90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x105520c90>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x105517f90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x105517f90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x105520c90>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:16.475656+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x105517890>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x102935690>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285690>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285690>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105517890>
                 └ <aiohttp.client.ClientSession object at 0x102935690>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1055154d0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x105517890>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1055154d0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x105517890>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x105517890>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1055154d0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:19.273193+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x105514290>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1048c4ed0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105286350>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105286350>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105514290>
                 └ <aiohttp.client.ClientSession object at 0x1048c4ed0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f26d0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x105514290>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f26d0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x105514290>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x105514290>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f26d0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:21.492589+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x105514390>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1055153d0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1052862f0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1052862f0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105514390>
                 └ <aiohttp.client.ClientSession object at 0x1055153d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f3550>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x105514390>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f3550>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x105514390>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x105514390>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f3550>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:24.289077+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054f29d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054f3350>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105363b50>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105363b50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054f29d0>
                 └ <aiohttp.client.ClientSession object at 0x1054f3350>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f2f50>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054f29d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f2f50>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054f29d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054f29d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f2f50>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:26.509058+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054f2e90>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054f2410>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105363ee0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105363ee0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054f2e90>
                 └ <aiohttp.client.ClientSession object at 0x1054f2410>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f7e50>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054f2e90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f7e50>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054f2e90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054f2e90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f7e50>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:29.304490+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x105515d50>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x105516d50>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105363760>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105363760>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105515d50>
                 └ <aiohttp.client.ClientSession object at 0x105516d50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f4ed0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x105515d50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f4ed0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x105515d50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x105515d50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f4ed0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:31.526061+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054f71d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054f5c50>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105363b20>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105363b20>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054f71d0>
                 └ <aiohttp.client.ClientSession object at 0x1054f5c50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e6ad0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054f71d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e6ad0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054f71d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054f71d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e6ad0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:34.317802+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054f7690>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x102cfdd90>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105286350>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105286350>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054f7690>
                 └ <aiohttp.client.ClientSession object at 0x102cfdd90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f29d0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054f7690>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f29d0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054f7690>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054f7690>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f29d0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:36.567871+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054f1890>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054f3590>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285690>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285690>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054f1890>
                 └ <aiohttp.client.ClientSession object at 0x1054f3590>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f2610>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054f1890>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f2610>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054f1890>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054f1890>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f2610>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:39.370602+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054f28d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054f3d90>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285f90>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285f90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054f28d0>
                 └ <aiohttp.client.ClientSession object at 0x1054f3d90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x105515710>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054f28d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x105515710>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054f28d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054f28d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x105515710>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:41.581604+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1055153d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x105515450>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1053638b0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1053638b0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1055153d0>
                 └ <aiohttp.client.ClientSession object at 0x105515450>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e5cd0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1055153d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e5cd0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1055153d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1055153d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e5cd0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:44.391881+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054f4210>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x105515cd0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105363c70>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105363c70>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054f4210>
                 └ <aiohttp.client.ClientSession object at 0x105515cd0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e3c50>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054f4210>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e3c50>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054f4210>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054f4210>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e3c50>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:46.596254+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054e4b50>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054e58d0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105363100>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105363100>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054e4b50>
                 └ <aiohttp.client.ClientSession object at 0x1054e58d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e1310>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054e4b50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e1310>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054e4b50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054e4b50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e1310>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:49.409235+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054e0fd0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054f16d0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1053634c0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1053634c0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054e0fd0>
                 └ <aiohttp.client.ClientSession object at 0x1054f16d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e0410>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054e0fd0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e0410>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054e0fd0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054e0fd0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e0410>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:51.612396+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054e0390>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054e0350>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285870>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285870>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054e0390>
                 └ <aiohttp.client.ClientSession object at 0x1054e0350>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x105514ad0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054e0390>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x105514ad0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054e0390>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054e0390>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x105514ad0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:54.426649+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x105514910>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1055156d0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105286350>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105286350>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105514910>
                 └ <aiohttp.client.ClientSession object at 0x1055156d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e6610>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x105514910>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e6610>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x105514910>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x105514910>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e6610>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:56.628344+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054e61d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x105517b10>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285d50>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285d50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054e61d0>
                 └ <aiohttp.client.ClientSession object at 0x105517b10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f1890>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054e61d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f1890>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054e61d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054e61d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f1890>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:42:59.442873+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054f2990>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1055152d0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105363250>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105363250>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054f2990>
                 └ <aiohttp.client.ClientSession object at 0x1055152d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054dad90>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054f2990>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054dad90>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054f2990>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054f2990>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054dad90>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:43:01.642926+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054f2a10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054f7790>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105363d60>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105363d60>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054f2a10>
                 └ <aiohttp.client.ClientSession object at 0x1054f7790>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054d8390>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054f2a10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054d8390>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054f2a10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054f2a10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054d8390>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:43:04.462634+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054f0fd0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1050d3e50>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1053629b0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1053629b0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054f0fd0>
                 └ <aiohttp.client.ClientSession object at 0x1050d3e50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c6150>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054f0fd0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c6150>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054f0fd0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054f0fd0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c6150>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:43:06.660115+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1055173d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054d9d10>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105362e90>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105362e90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1055173d0>
                 └ <aiohttp.client.ClientSession object at 0x1054d9d10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c7bd0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1055173d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c7bd0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1055173d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1055173d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c7bd0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:43:09.482097+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054f0890>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054f7250>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285600>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285600>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054f0890>
                 └ <aiohttp.client.ClientSession object at 0x1054f7250>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f26d0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054f0890>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f26d0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054f0890>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054f0890>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054f26d0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:43:11.678171+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054f2f50>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054f0710>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105285870>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105285870>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054f2f50>
                 └ <aiohttp.client.ClientSession object at 0x1054f0710>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e5990>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054f2f50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e5990>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054f2f50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054f2f50>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054e5990>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:43:14.498821+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054e7ad0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1054f24d0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1052855a0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1052855a0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054e7ad0>
                 └ <aiohttp.client.ClientSession object at 0x1054f24d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054da490>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054e7ad0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054da490>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054e7ad0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054e7ad0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054da490>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:43:16.692546+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054dbf90>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x102935690>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105362c20>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105362c20>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054dbf90>
                 └ <aiohttp.client.ClientSession object at 0x102935690>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c52d0>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054dbf90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c52d0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054dbf90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054dbf90>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054c52d0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:43:19.513520+0300 | ERROR | MessageHandler:listen_review_messages:149 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x105516310>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 135, in listen_review_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x1049ea350>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105363970>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105363970>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105516310>
                 └ <aiohttp.client.ClientSession object at 0x1049ea350>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b9d10>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x105516310>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b9d10>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x105516310>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x105516310>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054b9d10>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:43:21.710423+0300 | ERROR | MessageHandler:listen_blank_messages:172 - Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
                 │    │     │                  │       └ {'ssl': None, 'family': 0, 'proto': 0, 'flags': 0, 'server_hostname': None, 'local_addr': None}
                 │    │     │                  └ (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=True closed=False deb...
                 │    │     └ <function BaseEventLoop.create_connection at 0x102ee54e0>
                 │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                 └ <aiohttp.connector.TCPConnector object at 0x1054f3790>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1079, in create_connection
    raise exceptions[0]
          └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1063, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x102ee5440>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 967, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('127.0.0.1', 6660)
          │    │            └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>
          │    └ <function BaseSelectorEventLoop.sock_connect at 0x102ff8040>
          └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 634, in sock_connect
    return await fut
                 └ None
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/selector_events.py", line 674, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
                  └ 61

ConnectionRefusedError: [Errno 61] Connect call failed ('127.0.0.1', 6660)


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 10, in <module>
    main()
    └ <function main at 0x1027405e0>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/main.py", line 6, in main
    execute()
    └ <CommandCollection None>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function BaseCommand.main at 0x102bfeca0>
           └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x1027ce4d0>
         │    └ <function MultiCommand.invoke at 0x102bffec0>
         └ <CommandCollection None>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x1027ce2d0>
           │               │       │       └ <function Command.invoke at 0x102bff880>
           │               │       └ <Command run_handler>
           │               └ <click.core.Context object at 0x1027ce2d0>
           └ <function MultiCommand.invoke.<locals>._process_result at 0x10513fb00>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {}
           │   │      │    │           └ <click.core.Context object at 0x1027ce2d0>
           │   │      │    └ <function run_handler at 0x102c0ba60>
           │   │      └ <Command run_handler>
           │   └ <function Context.invoke at 0x102bfe200>
           └ <click.core.Context object at 0x1027ce2d0>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
                       │       └ {}
                       └ ()

  File "/Users/vblacksquare/Documents/projects/AutoReplier/cli/run_handler.py", line 18, in run_handler
    msg_handler.listen()
    │           └ <function MessageHandler.listen at 0x105283ce0>
    └ <message_handler.MessageHandler object at 0x10515b050>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 180, in listen
    loop.run_until_complete(self.listen_blank_messages())
    │    │                  │    └ <function MessageHandler.listen_blank_messages at 0x105283c40>
    │    │                  └ <message_handler.MessageHandler object at 0x10515b050>
    │    └ <function BaseEventLoop.run_until_complete at 0x102ee45e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102ee4540>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee6340>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1919, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e76c00>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...0.1', 6660)")>)>

> File "/Users/vblacksquare/Documents/projects/AutoReplier/message_handler/__init__.py", line 158, in listen_blank_messages
    async with http_client.get(f"{CONN_API}/messages", json={
               │           └ <function ClientSession.get at 0x10513c360>
               └ <aiohttp.client.ClientSession object at 0x10319ae10>

  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105362b30>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105362b30>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1050a8fe0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1054f3790>
                 └ <aiohttp.client.ClientSession object at 0x10319ae10>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1054bb010>
                  │    └ <function TCPConnector._create_connection at 0x1050a9bc0>
                  └ <aiohttp.connector.TCPConnector object at 0x1054f3790>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1054bb010>
                     │    └ <function TCPConnector._create_direct_connection at 0x1050aa2a0>
                     └ <aiohttp.connector.TCPConnector object at 0x1054f3790>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1235, in _create_direct_connection
    raise last_exc
          └ ClientConnectorError(ConnectionKey(host='127.0.0.1', port=6660, is_ssl=False, ssl=True, proxy=None, proxy_auth=None, proxy_he...
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                          │    └ <function TCPConnector._wrap_create_connection at 0x1050a9e40>
                          └ <aiohttp.connector.TCPConnector object at 0x1054f3790>
  File "/Users/vblacksquare/Documents/projects/AutoReplier/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
          │            │   └ <property object at 0x104dffa10>
          │            └ <aiohttp.client_reqrep.ClientRequest object at 0x1054bb010>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 127.0.0.1:6660 ssl:default [Connect call failed ('127.0.0.1', 6660)]
2024-04-22T13:43:35.116138+0300 | INFO | None:<module>:20 - Started logging successfully
2024-04-22T13:44:05.770334+0300 | DEBUG | MessageHandler:listen_blank_messages:167 - Got 1 blank messages
2024-04-22T13:44:05.771394+0300 | INFO | MessageHandler:fill_blank_message:26 - Got blank_message = <dtypes.message.Message object at 0x103707d10>
2024-04-22T13:44:20.948773+0300 | INFO | MessageHandler:fill_blank_message:45 - Got gpt response -> {'status': 'ok', 'description': 'ok', 'data': 'I\'m here to assist, but it seems there might be a misunderstanding or technical issue, as your inquiry about "Crystal: Форма слайдера" has been repeated without variation. If you\'ve specific requirements or questions about this topic, detailing them would greatly aid in providing you with accurate and helpful information.\n\nIn the context of slider forms, whether it involves design, implementation, or optimization for user engagement, Innova Consulting Group possesses the expertise and experience to support your needs effectively. Please share more about your project goals, the challenges you\'re facing, or any particular aspects of the slider form you\'re interested in discussing.\n\nYour cooperation and additional details are much appreciated to move forward constructively.\n\nBest regards,\nOleg Shevchenko'}
2024-04-22T13:44:21.001421+0300 | DEBUG | MessageHandler:fill_blank_message:50 - Got updated_message_response -> {'status': 'ok', 'description': 'ok', 'data': "UpdateResult({'n': 1, 'electionId': ObjectId('7fffffff00000000000000bd'), 'opTime': {'ts': Timestamp(1713782661, 6), 't': 189}, 'nModified': 1, 'ok': 1.0, '$clusterTime': {'clusterTime': Timestamp(1713782661, 6), 'signature': {'hash': b'\\xe6\\x8f\\xb9\\xb3y\\x10\\xa0\\xb4X\\x0eZ3\\xfed\\x06\\x8e\\xf3\\n\\xab\\x93', 'keyId': 7306544719813672961}}, 'operationTime': Timestamp(1713782661, 6), 'updatedExisting': True}, acknowledged=True)"}
